name = "tradingview-gate-webhook"
account_id = "cd9eceaa891fe8b1bdf7da893a231203"
main = "src/index.js"
compatibility_date = "2024-11-12"
compatibility_flags = ["nodejs_compat"]

[[durable_objects.bindings]]
name = "SYMBOL_EXECUTOR"
class_name = "SymbolExecutor"

[[migrations]]
tag = "v1"
new_classes = ["SymbolExecutor"]

[vars]
ENABLE_IP_WHITELIST = "false"
FUTURES_SETTLE = "usdt"
# Position mode for futures trading:
# - "dual_long_short": Dual position mode (全仓) - Can hold both long and short positions simultaneously
# - "single": Single position mode - Can only hold one direction at a time
# Recommended: "dual_long_short" for more flexible trading strategies
POSITION_MODE = "dual_long_short"
# Margin mode preference for futures orders ("cross", "isolated", or unset to skip auto-switching)
MARGIN_MODE = "cross"

# These will be set as secrets using:
# wrangler secret put GATE_API_KEY
# wrangler secret put GATE_API_SECRET
# wrangler secret put WEBHOOK_SECRET (optional, for payload authentication)

# Optional KV Namespaces for storing logs and rate limiting
# Create these with:
# wrangler kv namespace create "TRADE_LOGS"
# wrangler kv namespace create "RATE_LIMITER"

[[kv_namespaces]]
binding = "TRADE_LOGS"
id = "c4703ef6b8af4580aef4d05c75edd030"

[[kv_namespaces]]
binding = "RATE_LIMITER"
id = "7b51f7b49e7f425da20e99150f6cab58"

# Development settings
[dev]
port = 8787
local_protocol = "http"

[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
persist = true

[observability.traces]
enabled = false
persist = true
head_sampling_rate = 1